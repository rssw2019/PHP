
   <form action="" method="POST"> 
    <div class="row">
    <div class="col-sm-12 col-md-2">
    <!-- Minimum Price --->
            <label>Min Price</label>
            <input type="number" min="1"  name ="minprice" class="form-control" required> </input> 
    </div>
    <div class="col-sm-12 col-md-2">
    <!-- Maximum Price --->
            <label>Max Price</label>
            <input type="number" min="2" name ="maxprice" class="form-control" required> </input> 
    </div>
    <div class="col-sm-12 col-md-2">
    <!-- Search By Discrict --->                   
            <label>District</label>        
            <select class="form-select"  name="district" required>
                <option value="Select">  </option>
                <option value ="Achham" name ="Achham"> Achham </option>
                <option value ="Arghakhanchi" name ="Arghakhanchi"> Arghakhanchi </option>
                <option value ="Baglung" name ="Baglung"> Baglung </option>
                <option value ="Baitadi" name ="Baitadi"> Baitadi </option>
                <option value ="Bajhang" name ="Bajhang"> Bajhang </option>
                <option value ="Bajura" name ="Bajura"> Bajura </option>
                <option value ="Banke" name ="Banke"> Banke </option>
                <option value ="Bara" name ="Bara"> Bara </option>
                <option value ="Bardiya" name ="Bardiya"> Bardiya </option>
                <option value ="Bhaktapur" name ="Bhaktapur"> Bhaktapur </option>
                <option value ="Bhojpur" name ="Bhojpur"> Bhojpur </option>
                <option value ="Chitwan" name ="Chitwan"> Chitwan </option>
                <option value ="Dadeldhura" name ="Dadeldhura"> Dadeldhura </option>
                <option value ="Dailekh" name ="Dailekh"> Dailekh </option>
                <option value ="Dang" name ="Dang"> Dang </option>
                <option value ="Darchula" name ="Darchula"> Darchula </option>
                <option value ="Dhading" name ="Dhading"> Dhading </option>
                <option value ="Dhankuta" name ="Dhankuta"> Dhankuta </option>
                <option value ="Dhanusha" name ="Dhanusha"> Dhanusha </option>
                <option value ="Dolakha" name ="Dolakha"> Dolakha </option>
                <option value ="Dolpa" name ="Dolpa"> Dolpa </option>
                <option value ="Doti" name ="Doti"> Doti </option>
                <option value ="Eastern Rukum" name ="Eastern Rukum"> Eastern Rukum </option>
                <option value ="Gorkha" name ="Gorkha"> Gorkha </option>
                <option value ="Gulmi" name ="Gulmi"> Gulmi </option>
                <option value ="Humla" name ="Humla"> Humla </option>
                <option value ="Ilam" name ="Ilam"> Ilam </option>
                <option value ="Jajarkot" name ="Jajarkot"> Jajarkot </option>
                <option value ="Jhapa" name ="Jhapa"> Jhapa </option>
                <option value ="Jumla" name ="Jumla"> Jumla </option>
                <option value ="Kailali" name ="Kailali"> Kailali </option>
                <option value ="Kalikot" name ="Kalikot"> Kalikot </option>
                <option value ="Kanchanpur" name ="Kanchanpur"> Kanchanpur </option>
                <option value ="Kapilvastu" name ="Kapilvastu"> Kapilvastu </option>
                <option value ="Kaski" name ="Kaski"> Kaski </option>
                <option value ="Kathmandu" name ="Kathmandu"> Kathmandu </option>
                <option value ="Kavrepalanchok" name ="Kavrepalanchok"> Kavrepalanchok </option>
                <option value ="Khotang" name ="Khotang"> Khotang </option>
                <option value ="Lalitpur" name ="Lalitpur"> Lalitpur </option>
                <option value ="Lamjung" name ="Lamjung"> Lamjung </option>
                <option value ="Mahottari" name ="Mahottari"> Mahottari </option>
                <option value ="Makwanpur" name ="Makwanpur"> Makwanpur </option>
                <option value ="Manang" name ="Manang"> Manang </option>
                <option value ="Morang" name ="Morang"> Morang </option>
                <option value ="Mugu" name ="Mugu"> Mugu </option>
                <option value ="Mustang" name ="Mustang"> Mustang </option>
                <option value ="Myagdi" name ="Myagdi"> Myagdi </option>
                <option value ="Nawalpur" name ="Nawalpur"> Nawalpur </option>
                <option value ="Nuwakot" name ="Nuwakot"> Nuwakot </option>
                <option value ="Okhaldhunga" name ="Okhaldhunga"> Okhaldhunga </option>
                <option value ="Palpa" name ="Palpa"> Palpa </option>
                <option value ="Panchthar" name ="Panchthar"> Panchthar </option>
                <option value ="Parasi" name ="Parasi"> Parasi </option>
                <option value ="Parbat" name ="Parbat"> Parbat </option>
                <option value ="Parsa" name ="Parsa"> Parsa </option>
                <option value ="Pyuthan" name ="Pyuthan"> Pyuthan </option>
                <option value ="Ramechhap" name ="Ramechhap"> Ramechhap </option>
                <option value ="Rasuwa" name ="Rasuwa"> Rasuwa </option>
                <option value ="Rautahat" name ="Rautahat"> Rautahat </option>
                <option value ="Rolpa" name ="Rolpa"> Rolpa </option>
                <option value ="Rupandehi" name ="Rupandehi"> Rupandehi</option>
                <option value ="Salyan" name ="Salyan"> Salyan </option>
                <option value ="Sankhuwasabha" name ="Sankhuwasabha"> Sankhuwasabha </option>
                <option value ="Saptari" name ="Saptari"> Saptari </option>
                <option value ="Sarlahi" name ="Sarlahi"> Sarlahi </option>
                <option value ="Sindhuli" name ="Sindhuli"> Sindhuli </option>
                <option value ="Sindhupalchok" name ="Sindhupalchok"> Sindhupalchok </option>
                <option value ="Siraha" name ="Siraha"> Siraha </option>
                <option value ="Solukhumbu" name ="Solukhumbu"> Solukhumbu </option>
                <option value ="Sunsari" name ="Sunsari"> Sunsari </option>
                <option value ="Surkhet" name ="Surkhet"> Surkhet </option>
                <option value ="Syangja" name ="Syangja"> Syangja </option>
                <option value ="Tanahun" name ="Tanahun"> Tanahun </option>
                <option value ="Taplejung" name ="Taplejung"> Taplejung </option>
                <option value ="Tehrathum" name ="Tehrathum"> Tehrathum </option>
                <option value ="Udayapur" name ="Udayapur"> Udayapur </option>
                <option value ="Western Rukum" name ="Western Rukum"> Western Rukum </option>
            </select>
        </div>
    <div class="col-sm-12 col-md-2">
    <!---Search by Property Type ---->
            <label>Type </label>      
            <select class="form-select"  name="proptype" required>
                <option value="Select">  </option>
                <option value ="house" name ="house"> House </option>
                <option value ="land" name ="land"> Land </option>
                <option value ="apartment" name ="apartment"> Apartment/Flat/Room </option>
            </select>
            </div>
    <div class="col-sm-12 col-md-2">
            <br>
            <!-- Submit Button -->
            <button type="submit" class="btn btn-primary" name = "submit"> Search </button> 
</div>
</div>
    </form>

<div class="col-10">

    <!--Displaying Search Results --->
    <?php
        if(isset($_POST['submit'])){
            $rowCount=0;            
            $user_minprice= $_POST['minprice'];
            $user_maxprice= $_POST['maxprice'];
            $user_district=$_POST['district'];
            $user_proptype=$_POST['proptype'];

            if (isset($user_minprice)) {
                $q ="select * from prop_listing_tble WHERE status='1' AND price > $user_minprice AND price < $user_maxprice AND district='$user_district' AND proptype= '$user_proptype' AND selltype= 'sale' ORDER BY date DESC";
                
                $query =mysqli_query($conn, $q);
                
                //echo $SmallestPrice;
                $rowCount = mysqli_num_rows($query);
                //$rowCount = 10;
                //echo "rowcount=".$rowCount;
                if($rowCount>0){
                    if($rowCount<2){
                        echo "<p> We found ".$rowCount." record with your criteria.</p>";
                    }
                    else{
                        echo "<p> We found ".$rowCount." records with your criteria.</p>";
                    }
                    echo "<div class =\"card\">";
                        echo "<div class=\"card-header\">";
                            echo "<b> Your Search Result </b>";
                        echo "</div>";
                    
                    while($rows = mysqli_fetch_array($query)){
    ?>      
                        <div class ="card-body">
                            <p class ="card-body-text">
                                <div class="row">
                                    <div class="col-sm-12 col-md-2">
                                        <div class="input-group">
                                            Listed Date: <?php echo $rows['date']; ?><br>
                                            <?php echo $rows['proptype']; ?>  for <?php echo $rows['selltype']; ?><br>
                                            Contact Name: <?php echo $rows['name']; ?> <br>
                                            Email: <?php echo $rows['email']; ?><br>
                                            Phone1: <?php echo $rows['phone1'];?> <br>
                                            Phone2: <?php echo $rows['phone2'];?> <br>
                                        </div>
                                    </div>
                                    <div class ="col-sm-12 col-md-2">
                                        <div class="input-group">
                                            <b>Property Address </b> <?php echo $rows['district']; ?> discrict, <?php echo $rows['vdc']; ?> Municipality/VDC, Ward number <?php echo $rows['ward'];?> <br>
                                            Property Size/Area: <?php echo $rows['area']." ". $rows['unit']; ?> <br>
                                            <?php 
                                            if($rows['selltype']=='rent'){
                                                echo "Rent: ".$rows['price']." Per Month";
                                            } 
                                            else {
                                                echo "Price: Rs. ".$rows['price']; 
                                            }
                                            ?> 
                                            <br>
                                            <b> More Information </b><br>
                                            <p> <?php echo " ".$rows['message']; ?></p>
                                        </div>
                                </div>
                            </p>
                        </div>
                    <hr>
                    
    <?php
                    }
                    echo "</div>";
                }
                else{
                    echo "<p>There are no records with your criteria. Please select all items and try again.";
                }
                
            }
        }
    ?>   
</div>
